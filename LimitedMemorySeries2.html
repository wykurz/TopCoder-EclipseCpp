<html><body bgcolor="#000000" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><i>Due to some infrastructure limits the memory limit is set to 13 MB. Note that this should correspond to an actual memory limit of only 1 MB. If your solution allocates more than 1 MB of memory, it may exceed the memory limit.</i>

<p>
You are given an array X[0..n-1] of integers.
For each i between 0 and n-1, inclusive, the radius of element i is the largest k with the following properties:
<ul>
<li>Both i-k and i+k are valid indices into the array. That is, i-k &gt;= 0 and i+k &lt; n.</li>
<li>The value X[i] is the strict maximum among the values X[i-k], X[i-k+1], ..., X[i+k]. (Here, "strict" means that the values at all other indices must be strictly smaller.)</li>
</ul>
</p>

<p>
For example, in the array X = {4,4,4,4,4} the radius of each element is 0, and in the array X = {10,20,30,20} the radius of element 2 (0-based index) is 1.
</p>

<p>
Your task is to find the radius of each element of X and to compute the sum of all those radii.
Right now, this seems like a fairly standard problem.
Here's the catch: the memory limit in this problem is really small.
So small that you cannot even store the array X into memory.
</p>

<p>
You are given the int <b>n</b> and the long longs <b>x0</b>, <b>a</b>, and <b>b</b>.
Use the following pseudocode to generate the array X:
</p>

<pre>
X[0] = x0
for i = 1 to n-1:
        X[i] = ((X[i-1] XOR a) + b) AND ((2^50) - 1)
</pre>

<p>
In the above pseudocode, XOR and AND are the standard operators "bitwise xor" and "bitwise and".
</p>

<p>
Return the sum of radii of all elements of X, modulo 1,000,000,007.
</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>LimitedMemorySeries2</td></tr><tr><td>Method:</td><td>getSum</td></tr><tr><td>Parameters:</td><td>int, long long, long long, long long</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int getSum(int n, long long x0, long long a, long long b)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>13</td></tr><tr><td>Stack limit (MB):</td><td>13</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> will be between 1 and 10,000,000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>x0, a</b> and <b>b</b> will be between 0 and 2^50-1, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>6</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>23</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 2</pre></td></tr><tr><td><table><tr><td colspan="2">In this case, the generated array is X = {2,22,2,22,2,22}.
The radii of its elements are {0,1,0,1,0,0}.
The correct return value is 0+1+0+1+0+0 = 2.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>100</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2">Here, the generated array is {0,1,...,99}. The radius of each element is zero, so the answer is zero in this case.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>234234</pre></td></tr><tr><td><pre>1125899906842623</pre></td></tr><tr><td><pre>123456789123456</pre></td></tr><tr><td><pre>987654321549687</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1144970</pre></td></tr><tr><td><table><tr><td colspan="2">Don't forget, the answer is modulo 1,000,000,007.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>10000000</pre></td></tr><tr><td><pre>12345678912345</pre></td></tr><tr><td><pre>98765094309812</pre></td></tr><tr><td><pre>34893049812392</pre></td></tr></table></td></tr><tr><td><pre>Returns: 65420804</pre></td></tr><tr><td><table><tr><td colspan="2">It is highly recommended to test this example in the arena before submitting.</td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
